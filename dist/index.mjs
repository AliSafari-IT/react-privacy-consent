import {createContext,useCallback,useState,useEffect,useContext}from'react';import {jsx,jsxs,Fragment}from'react/jsx-runtime';function B(t){let e=typeof Storage<"u",s=useCallback(n=>{if(e)try{let a=JSON.stringify(n);localStorage.setItem(t,a);}catch(a){console.warn("Failed to save consent to localStorage:",a);}},[t,e]),r=useCallback(()=>{if(!e)return null;try{let n=localStorage.getItem(t);if(!n)return null;let a=JSON.parse(n);return !a||!a.decisions||!a.version?null:{...a,lastUpdated:new Date(a.lastUpdated),decisions:a.decisions.map(u=>({...u,timestamp:new Date(u.timestamp)}))}}catch(n){return console.warn("Failed to load consent from localStorage:",n),null}},[t,e]),l=useCallback(()=>{if(e)try{localStorage.removeItem(t);}catch(n){console.warn("Failed to clear consent from localStorage:",n);}},[t,e]);return {saveConsent:s,loadConsent:r,clearConsent:l,isStorageAvailable:e}}function U(){return "session_"+Date.now()+"_"+Math.random().toString(36).substring(2,15)}function k(t,e,s,r){return {userId:r,sessionId:t,decisions:e,lastUpdated:new Date,version:s,userAgent:typeof navigator<"u"?navigator.userAgent:void 0}}function X(t,e){return !!(t&&t.version===e&&t.decisions&&Array.isArray(t.decisions)&&t.lastUpdated&&t.sessionId)}function Y(t,e){return t?t.decisions.find(r=>r.categoryId===e)?.status==="accepted":false}function Z(t,e){let s=[...t];return e.forEach(r=>{let l=s.findIndex(n=>n.categoryId===r.categoryId);l>=0?s[l]=r:s.push(r);}),s}function K(t,e){if(!t.lastUpdated)return  true;let s=new Date(t.lastUpdated);return s.setDate(s.getDate()+e),s<=new Date}function ee(t){return {userId:t.userId,sessionId:t.sessionId,decisions:t.decisions.map(e=>({categoryId:e.categoryId,status:e.status,timestamp:new Date(e.timestamp),version:e.version})),lastUpdated:new Date(t.lastUpdated),version:t.version,ipAddress:t.ipAddress,userAgent:t.userAgent}}function I(t){let e=document.documentElement;e.style.setProperty("--consent-primary-color",t.primaryColor),e.style.setProperty("--consent-secondary-color",t.secondaryColor),e.style.setProperty("--consent-background-color",t.backgroundColor),e.style.setProperty("--consent-text-color",t.textColor),e.style.setProperty("--consent-border-color",t.borderColor),e.style.setProperty("--consent-border-radius",t.borderRadius),e.style.setProperty("--consent-font-family",t.fontFamily),e.style.setProperty("--consent-font-size",t.fontSize),e.style.setProperty("--consent-button-style",t.buttonStyle),e.style.setProperty("--consent-shadow",t.shadow?"0 4px 6px rgba(0, 0, 0, 0.1)":"none");}function te(){let t=document.documentElement;["--consent-primary-color","--consent-secondary-color","--consent-background-color","--consent-text-color","--consent-border-color","--consent-border-radius","--consent-font-family","--consent-font-size","--consent-button-style","--consent-shadow"].forEach(s=>{t.style.removeProperty(s);});}function ne(){return {primaryColor:"#007bff",secondaryColor:"#6c757d",backgroundColor:"#ffffff",textColor:"#212529",borderColor:"#dee2e6",borderRadius:"0.375rem",fontFamily:"system-ui, -apple-system, sans-serif",fontSize:"14px",buttonStyle:"solid",shadow:true}}function oe(){return {primaryColor:"#0d6efd",secondaryColor:"#adb5bd",backgroundColor:"#212529",textColor:"#ffffff",borderColor:"#495057",borderRadius:"0.375rem",fontFamily:"system-ui, -apple-system, sans-serif",fontSize:"14px",buttonStyle:"solid",shadow:true}}var z=createContext(void 0);function ae({children:t,config:e}){let[s,r]=useState(false),[l,n]=useState(false),[a,u]=useState(null),[m]=useState(()=>U()),{saveConsent:f,loadConsent:o,clearConsent:x}=B(e.settings.storageKey);useEffect(()=>{let i=o();if(i&&i.version===e.settings.version){let b=new Date(i.lastUpdated);if(b.setDate(b.getDate()+e.settings.expirationDays),b>new Date){u(i);return}}let c=e.settings.autoShowDelay||0;setTimeout(()=>{(!i||i.version!==e.settings.version)&&(r(true),e.onBannerShow?.());},c);},[e,o]),useEffect(()=>{e.theme&&I(e.theme);},[e.theme]),useEffect(()=>{if(e.settings.respectDoNotTrack&&navigator.doNotTrack==="1"){let i=k(m,e.settings.categories.map(c=>({categoryId:c.id,status:c.required?"accepted":"rejected",timestamp:new Date,version:e.settings.version})),e.settings.version);u(i),f(i),r(false);}},[e.settings,m,f]);let v=useCallback(()=>{r(true),e.onBannerShow?.();},[e]),P=useCallback(()=>{r(false),e.onBannerHide?.();},[e]),_=useCallback(()=>{n(true);},[]),y=useCallback(()=>{n(false);},[]),g=useCallback(i=>{let c=k(m,i,e.settings.version);return u(c),f(c),e.onConsentChange?.(c),c},[m,e,f]),w=useCallback(()=>{let i=e.settings.categories.map(c=>({categoryId:c.id,status:"accepted",timestamp:new Date,version:e.settings.version}));g(i),r(false),n(false),e.onBannerHide?.();},[e,g]),F=useCallback(()=>{let i=e.settings.categories.map(c=>({categoryId:c.id,status:c.required?"accepted":"rejected",timestamp:new Date,version:e.settings.version}));g(i),r(false),n(false),e.onBannerHide?.();},[e,g]),L=useCallback((i,c)=>{if(!a)return;let b=a.decisions.filter(Q=>Q.categoryId!==i),G={categoryId:i,status:c?"accepted":"rejected",timestamp:new Date,version:e.settings.version};g([...b,G]);},[a,e.settings.version,g]),S=useCallback(i=>a&&a.decisions.find(b=>b.categoryId===i)?.status||"pending",[a]),$=useCallback(()=>a,[a]),J=useCallback(i=>S(i)==="accepted",[S]),O=useCallback(()=>{x(),u(null),r(true),n(false),e.onBannerShow?.();},[x,e]),W={isVisible:s,showBanner:v,hideBanner:P,showPreferences:_,hidePreferences:y,acceptAll:w,rejectAll:F,updateConsent:L,getConsent:S,getAllConsent:$,hasConsent:J,resetConsent:O,isPreferencesVisible:l,consentRecord:a,config:e};return jsx(z.Provider,{value:W,children:t})}function V(){let t=useContext(z);if(t===void 0)throw new Error("useConsentContext must be used within a ConsentProvider");return t}function T(){return V()}function ce({className:t="",style:e={},onAcceptAll:s,onRejectAll:r,onManagePreferences:l,children:n}){let{isVisible:a,acceptAll:u,rejectAll:m,showPreferences:f,config:o}=T();if(!a)return null;let x=()=>{u(),s?.();},v=()=>{m(),r?.();},P=()=>{f(),l?.();},_=["consent-banner",`consent-banner--${o.banner.position}`,`consent-banner--${o.banner.layout}`,o.banner.animation?"consent-banner--animated":"",t].filter(Boolean).join(" ");return jsxs(Fragment,{children:[o.banner.backdrop&&jsx("div",{className:"consent-backdrop"}),jsx("div",{className:_,style:e,role:"dialog","aria-labelledby":"consent-title","aria-describedby":"consent-description",children:n||jsxs("div",{className:"consent-banner__content",children:[jsxs("div",{className:"consent-banner__text",children:[jsx("h3",{id:"consent-title",className:"consent-banner__title",children:o.texts.title}),jsx("p",{id:"consent-description",className:"consent-banner__description",children:o.texts.description}),(o.texts.learnMoreUrl||o.texts.privacyPolicyUrl)&&jsxs("div",{className:"consent-banner__links",children:[o.texts.learnMoreUrl&&jsx("a",{href:o.texts.learnMoreUrl,target:"_blank",rel:"noopener noreferrer",className:"consent-banner__link",children:o.texts.learnMoreText}),o.texts.privacyPolicyUrl&&jsx("a",{href:o.texts.privacyPolicyUrl,target:"_blank",rel:"noopener noreferrer",className:"consent-banner__link",children:"Privacy Policy"})]})]}),jsxs("div",{className:"consent-banner__actions",children:[o.settings.showAcceptAll&&jsx("button",{onClick:x,className:"consent-button consent-button--primary",type:"button",children:o.texts.acceptAllText}),o.settings.showDeclineAll&&jsx("button",{onClick:v,className:"consent-button consent-button--secondary",type:"button",children:o.texts.rejectAllText}),o.settings.showManagePreferences&&jsx("button",{onClick:P,className:"consent-button consent-button--ghost",type:"button",children:o.texts.managePreferencesText})]}),o.banner.showCloseButton&&jsx("button",{onClick:v,className:"consent-banner__close","aria-label":o.texts.closeText,type:"button",children:"\xD7"}),o.texts.poweredByText&&jsx("div",{className:"consent-banner__powered-by",children:o.texts.poweredByText})]})})]})}function E({checked:t,onChange:e,disabled:s=false,size:r="md",className:l="",label:n}){let a=["consent-toggle",`consent-toggle--${r}`,t?"consent-toggle--checked":"",s?"consent-toggle--disabled":"",l].filter(Boolean).join(" ");return jsxs("label",{className:a,children:[jsx("input",{type:"checkbox",checked:t,onChange:m=>{s||e(m.target.checked);},disabled:s,className:"consent-toggle__input","aria-label":n}),jsx("span",{className:"consent-toggle__slider"}),n&&jsx("span",{className:"consent-toggle__label",children:n})]})}function j({category:t,value:e,onChange:s,disabled:r=false,className:l=""}){let n=["consent-category",r?"consent-category--disabled":"",t.required?"consent-category--required":"",l].filter(Boolean).join(" ");return jsxs("div",{className:n,children:[jsxs("div",{className:"consent-category__header",children:[jsx("h4",{className:"consent-category__name",children:t.name}),jsx(E,{checked:e,onChange:s,disabled:r,size:"md"})]}),jsx("p",{className:"consent-category__description",children:t.description}),t.required&&jsx("span",{className:"consent-category__required-badge",children:"Required"})]})}function ue({isOpen:t,onClose:e,className:s="",style:r={},showBackdrop:l=true}){let{config:n,consentRecord:a,updateConsent:u,acceptAll:m,rejectAll:f,hidePreferences:o}=T();if(!t)return null;let x=()=>{o(),e();},v=()=>{m(),e();},P=()=>{f(),e();},_=["consent-modal",s].filter(Boolean).join(" ");return jsxs(Fragment,{children:[l&&jsx("div",{className:"consent-modal__backdrop",onClick:e,role:"presentation"}),jsx("div",{className:_,style:r,role:"dialog","aria-labelledby":"consent-modal-title","aria-modal":"true",children:jsxs("div",{className:"consent-modal__content",children:[jsxs("div",{className:"consent-modal__header",children:[jsx("h2",{id:"consent-modal-title",className:"consent-modal__title",children:n.texts.managePreferencesText}),jsx("button",{onClick:e,className:"consent-modal__close","aria-label":n.texts.closeText,type:"button",children:"\xD7"})]}),jsxs("div",{className:"consent-modal__body",children:[jsx("p",{className:"consent-modal__description",children:n.texts.description}),jsx("div",{className:"consent-modal__categories",children:n.settings.categories.map(y=>{let g=a?.decisions.find(w=>w.categoryId===y.id)?.status==="accepted"||y.defaultValue;return jsx(j,{category:y,value:g,onChange:w=>u(y.id,w),disabled:y.required},y.id)})}),(n.texts.privacyPolicyUrl||n.texts.cookiePolicyUrl)&&jsxs("div",{className:"consent-modal__links",children:[n.texts.privacyPolicyUrl&&jsx("a",{href:n.texts.privacyPolicyUrl,target:"_blank",rel:"noopener noreferrer",className:"consent-modal__link",children:"Privacy Policy"}),n.texts.cookiePolicyUrl&&jsx("a",{href:n.texts.cookiePolicyUrl,target:"_blank",rel:"noopener noreferrer",className:"consent-modal__link",children:"Cookie Policy"})]})]}),jsx("div",{className:"consent-modal__footer",children:jsxs("div",{className:"consent-modal__actions",children:[jsx("button",{onClick:x,className:"consent-button consent-button--primary",type:"button",children:n.texts.savePreferencesText}),n.settings.showAcceptAll&&jsx("button",{onClick:v,className:"consent-button consent-button--secondary",type:"button",children:n.texts.acceptAllText}),n.settings.showDeclineAll&&jsx("button",{onClick:P,className:"consent-button consent-button--ghost",type:"button",children:n.texts.rejectAllText})]})})]})})]})}var Ce={categories:[{id:"necessary",name:"Necessary",description:"Essential cookies required for basic website functionality.",type:"necessary",required:true,defaultValue:true},{id:"analytics",name:"Analytics",description:"Cookies that help us understand how visitors interact with our website.",type:"analytics",required:false,defaultValue:false},{id:"marketing",name:"Marketing",description:"Cookies used to deliver personalized advertisements.",type:"marketing",required:false,defaultValue:false},{id:"preferences",name:"Preferences",description:"Cookies that remember your preferences and settings.",type:"preferences",required:false,defaultValue:false}],version:"1.0.0",expirationDays:365,storageKey:"asafarim-privacy-consent",showDeclineAll:true,showAcceptAll:true,showManagePreferences:true,autoShowDelay:1e3,respectDoNotTrack:true},me={position:"bottom",layout:"banner",showCloseButton:true,showCompanyLogo:false,blocking:false,animation:true,backdrop:false},fe={title:"We value your privacy",description:"We use cookies and similar technologies to provide the best experience on our website. Some are necessary for functionality, while others help us understand usage and improve our services.",acceptAllText:"Accept All",rejectAllText:"Reject All",managePreferencesText:"Manage Preferences",savePreferencesText:"Save Preferences",closeText:"Close",learnMoreText:"Learn More",poweredByText:"Powered by @asafarim/react-privacy-consent"},Fe={settings:Ce,banner:me,texts:fe};export{ce as ConsentBanner,j as ConsentCategory,ue as ConsentModal,ae as ConsentProvider,E as ConsentToggle,I as applyConsentTheme,k as createConsentRecord,me as defaultBannerConfig,fe as defaultConsentTexts,Fe as defaultPrivacyConsentConfig,Ce as defaultPrivacySettings,U as generateSessionId,Y as getConsentValue,oe as getDarkTheme,ne as getDefaultTheme,K as hasExpiredConsent,X as isValidConsentRecord,Z as mergeConsentDecisions,te as removeConsentTheme,ee as sanitizeConsentRecord,T as useConsent,V as useConsentContext,B as useConsentStorage};//# sourceMappingURL=index.mjs.map
//# sourceMappingURL=index.mjs.map